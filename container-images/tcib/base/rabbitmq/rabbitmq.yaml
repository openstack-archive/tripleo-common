tcib_actions:
- run: bash /usr/local/bin/uid_gid_manage {{ tcib_user }}
- run: dnf -y install {{ tcib_packages['common'] | join(' ') }} && dnf clean all && rm -rf /var/cache/dnf && rm -f /etc/rabbitmq/rabbitmq.conf
- run: cp /usr/share/openstack-tripleo-common-containers/container-images/kolla/rabbitmq/extend_start.sh /usr/local/bin/kolla_extend_start
- run: chmod 755 /usr/local/bin/kolla_extend_start
- run: ln -s /usr/share/openstack-tripleo-common/healthcheck/rabbitmq /openstack/healthcheck &&  chmod a+rx /openstack/healthcheck
tcib_packages:
  common:
  - hostname
  - libqb
  - pacemaker
  - pacemaker-remote
  - pcs
  - rabbitmq-server
  - resource-agents
tcib_user: rabbitmq
